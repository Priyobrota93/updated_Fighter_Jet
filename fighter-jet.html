<html>

<head>
	<title>Fighter Jet</title>
	
	<link rel="stylesheet" href="css/fontawesome_all.css">
	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="css/bootstrap.css">
	<link rel="stylesheet" href="css/style.css">
	<style>
		#startGame,
		#afterPause {
			position: absolute;
			left: 30%;
			top: 30%;
			box-shadow: 10px 10px;
		}

		#menu_buttons {
			bottom: 0;
			opacity: 0.7;
			height: 50px;
			width: 100%;
		}

		.menuButton {
			width: 100%;
		}

		#pause {
			position: absolute;
			z-index: 1;
			left: 0;
			height: 50px;
			border-radius: 0;

		}

	</style>
	<!-- <script src="jquery-2.2.js"></script> -->
</head>

<body>
	<audio id="fire">
		<source src="sound/sound_design_effect_descend_futuristic_short-[AudioTrimmer.com].mp3">
	</audio>
	<audio id="enemyKill">
		<source src="sound/Explosion+7.mp3">
	</audio>
	<audio id="collideEnemy">
		<source src="sound/explosion-[AudioTrimmer.com].mp3">
	</audio >
	<audio id="gameOver">
		<source src="sound/TunePocket-Game-Over-Sound-3-Preview-[AudioTrimmer.com].mp3">
	</audio>
 
	<div id="layers">
		<div class="  mx-auto vw-100 ">
			<button id="pause" class="btn btn-light border border-primary d-none" onclick="pauseGame()"><i class="fa-sharp fa-solid fa-pause"></i></button>
			<div class="row  w-100 m-0 bg-light px-5">
				<button id="pause" class="btn btn-light border border-primary d-none" onclick="pauseGame()"><i class="fa-sharp fa-solid fa-pause"></i></button>
				<div class=" d-flex justify-content-center">
					<h3 class="d-inline">Name:&nbsp</h3>
					<h3 id="name" class="d-inline"></h3>	
				</div>
				<div class="col-md-4 p-0 d-flex justify-content-center">
					<h3 id="level" class="d-inline"></h3>	
				</div>
				<div class="col-md-4 p-0 d-flex justify-content-center">
						<h3 class="d-inline ml-auto">Score: &nbsp;</h3>
						<h3 class="d-inline mr-auto" id="score"></h3>
				</div>
				<div class=" d-flex justify-content-center">
						<img src="images/lifeGone.png" alt="" id="life1" class="" width="30" height="50">
						<img src="images/lifeGone.png" alt="" id="life2" class="" width="30" height="50">
						<img src="images/lifeGone.png" alt="" id="life3" class="" width="30" height="50">
				</div>
				<button id="logOutBtn" class="ml-auto font-weight-bold"  >Logout</button>
				
			</div>
		</div>
		<div class="row p-0 m-0">
			
			<div class='wrapCanvas col d-flex justify-content-center w-100'>
				 
				<canvas id='canvasEnemy' width='1600' height='600'></canvas>
				<canvas id='canvasJet' width='1600' height='600'></canvas>
				<canvas id='canvasScore' width='1600' height='600'></canvas>
			</div>

			<div id="startGame" class="">
				<img src="images/start.avif"
				 style="height:400px;width:600px;opacity: 0.6;"></img>
				<div id="menu_buttons" class="row bg-info border mx-0" style="position:absolute;">
					<div class="col-sm-4">
						<button id="startButton" class="btn btn-danger menuButton" onclick="play()">Start Game</button>
					</div>
					<div class="col-sm-4">
						<button id="showHighScoreButton" class="btn btn-primary menuButton" onclick="HighScore()">High Score</button>
					</div>
					<div class="col-sm-4">
						<button id="showSettingsButton" class="btn btn-success menuButton" onclick="">Settings</button>
					</div>
				</div>



			</div>


			<div id="afterPause" style="display:none;">
		
				<img src="images/paused.jpg" style="height:400px;width:600px;opacity: 0.6;"></img>
				<div id="menu_buttons" class="row bg-info border mx-0" style="position:absolute;">
					
					<div class="col-sm-4">
						<button id="resume" class="btn btn-danger menuButton" onclick="resumeGame()">Resume Game</button>
					</div>
					<div class="col-sm-4">
						<button id="menuButton" class="btn btn-primary menuButton" onclick="menu()">Go to Menu</button>
					</div>
					<div class="col-sm-4">
						<button id="restartButton" class="btn btn-success menuButton" onclick="restart()">Restart</button>
					</div>
				</div>
			</div>

		</div>
		<div class="row">
			<div class="info col mt-5 d-flex justify-content-center">
				<h4 class="mr-3">Instructions: </h4>
				<p>
					<span>Arrow ( &larr; &rarr; &uarr; &darr; ) : <strong>To Move</strong></span><br>
					<span>Space : <strong>For Fire</strong></span>
				</p>
			</div>
		</div>
	

	<!-- <script>
		const token = localStorage.getItem("jwt");
        if (!token) {
			
			window.location.href = "./UserComponent/signup-signin.html";
         }
		
		 let logOutBtn = document.getElementById("logOutBtn");
		 logOutBtn.onclick = function () {
			const xhttp = new XMLHttpRequest();
            xhttp.open("POST", "http://localhost:3000/v1/auth/logout");
            xhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
			const refreshToken_value = localStorage.getItem("jwt-refresh");
			
			xhttp.send(
                JSON.stringify({
                    refreshToken: refreshToken_value,
                   
                })
            );
			
			
			xhttp.onreadystatechange = function () {
                const objects = JSON.parse(this.responseText);
                if (objects?.tokens?.access) {
                    
                     
                    window.location.href = "./UserComponent/signup-signin.html";
                    
                }
		}

	</script> -->
	<script>
    showHighScoreButton.onclick = function() {
        const xhttp = new XMLHttpRequest();
		const tokens = localStorage.getItem("jwt");

		
        xhttp.onload = function() {
            if (this.status === 200) {
                const highScore = JSON.parse(this.responseText);
				document.getElementById('showHighScoreButton').innerHTML = Number(highScore.highScore.maximumScore);
            }
        };
		
        xhttp.open("GET", "http://localhost:3000/v1/data/highscore-preview");
        xhttp.setRequestHeader("Content-Type", "application/json");
		xhttp.setRequestHeader("Authorization", "Bearer " + tokens);
		xhttp.send();
    };
</script>
	 
	  <script>
		const token = localStorage.getItem("jwt");
        if (!token) {
		
			window.location.href = "./UserComponent/signup-signin.html";
         }
		
		let logOutBtn = document.getElementById("logOutBtn");
		let tokensToRemove = ["jwt", "jwt-refresh"];
		
		logOutBtn.onclick = function () {
			
            for ( removeToken of tokensToRemove) {
			localStorage.removeItem(removeToken);
			
		}
		
			
			 window.location.href = "./UserComponent/signup-signin.html";
		  

        }
	</script>
	<!-- <script src="http://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
	 crossorigin="anonymous"></script> -->
	<script src='jquery.js'></script> 
	<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
	 crossorigin="anonymous"></script> -->
	<script src='popper.min.js'></script> 
	<!-- <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T"
	 crossorigin="anonymous"></script> -->
	<script src='bootstrap.min.js'></script> 
	<script src="Model/level.js"></script>
	<script src='view.js'></script>
	<script src='Model/jet.js'></script>
	<script src='Model/bullet.js'></script>
	<script src='Model/enemy.js'></script>
	<script src='Model/explosion.js'></script>
	<script src='Model/score.js'></script>
	<script src="fighterController.js"></script>
	<script src='Model/enemyBullet.js'></script>
	<script src="Model/enemyExplosion.js"></script>
	
	

</body>

</html>